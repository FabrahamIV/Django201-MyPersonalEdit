{% load static %}
<nav class="navbar navbar-expand-lg bg-body-tertiary bg-primary bg-gradient">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img src="{% static 'feed/svg/F.svg' %}" alt="Logo" width="35" height="auto" class="d-inline-block align-text-top">
      Fabraham
    </a>
    <button class="btn" id="darkModeToggle">
        <img src="{% static 'feed/svg/toogle_off.svg' %}" alt="Toggle" width="auto" height="30" id="toggleIcon" class="d-inline-block align-text-top">
    </button>
  </div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const toggleButton = document.getElementById('darkModeToggle');
  const toggleIcon = document.getElementById('toggleIcon');
  const htmlElement = document.documentElement;

  const currentTheme = localStorage.getItem('theme') || 'light';
  htmlElement.setAttribute('data-bs-theme', currentTheme);
  updateIcon(currentTheme);

  toggleButton.addEventListener('click', () => {
    document.body.classList.add('theme-transition');
    const newTheme = htmlElement.getAttribute('data-bs-theme') === 'dark' ? 'light' : 'dark';
    htmlElement.setAttribute('data-bs-theme', newTheme);
    localStorage.setItem('theme', newTheme);
    updateIcon(newTheme);

    setTimeout(() => {
      document.body.classList.remove('theme-transition');
    }, 400);
  });

  function updateIcon(theme) {
    const toggleIcon = document.getElementById('toggleIcon');
    toggleIcon.src = theme === 'dark'
      ? '/static/feed/svg/toogle_off.svg'
      : '/static/feed/svg/toogle_on.svg';
  }
</script>